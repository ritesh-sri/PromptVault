<Window x:Class="PromptVault.Dialogs.AddEditPromptDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Add Prompt" Height="650" Width="700"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        ResizeMode="CanResize"
        MinHeight="500" MinWidth="600">

    <Window.Resources>
        <!-- Reuse styles from MainWindow -->
        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="4,0"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>

        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="6" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Opacity" Value="0.9"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SecondaryButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
        </Style>
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock x:Name="DialogTitle" Text="➕ Add New Prompt" 
                       FontSize="24" FontWeight="SemiBold" 
                       Foreground="{DynamicResource TextBrush}"/>
            <TextBlock Text="Fill in the details below to create your prompt" 
                       FontSize="14" Foreground="{DynamicResource TextSecondaryBrush}" 
                       Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Form Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                <!-- Title -->
                <TextBlock Text="Title *" FontSize="14" FontWeight="SemiBold" 
                           Foreground="{DynamicResource TextBrush}" Margin="0,0,0,8"/>
                <TextBox x:Name="TitleTextBox" Style="{StaticResource ModernTextBoxStyle}" 
                         Margin="0,0,0,20" MaxLength="200"/>

                <!-- AI Provider -->
                <TextBlock Text="AI Provider *" FontSize="14" FontWeight="SemiBold" 
                           Foreground="{DynamicResource TextBrush}" Margin="0,0,0,8"/>
                <ComboBox x:Name="AIProviderComboBox" Style="{StaticResource ModernComboBoxStyle}"
                          Margin="0,0,0,4" SelectionChanged="AIProviderComboBox_SelectionChanged"
                          IsEditable="True">
                    <ComboBoxItem Content="ChatGPT" IsSelected="True"/>
                    <ComboBoxItem Content="Claude"/>
                    <ComboBoxItem Content="Gemini"/>
                    <ComboBoxItem Content="Copilot"/>
                    <ComboBoxItem Content="DeepSeek"/>
                    <ComboBoxItem Content="Grok"/>
                    <ComboBoxItem Content="Perplexity"/>
                    <ComboBoxItem Content="Unknown"/>
                </ComboBox>
                <TextBlock Text="You can type a custom AI provider name" 
                           FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" 
                           Margin="0,0,0,20"/>

                <!-- Model Version -->
                <TextBlock Text="Model Version *" FontSize="14" FontWeight="SemiBold" 
                           Foreground="{DynamicResource TextBrush}" Margin="0,0,0,8"/>
                <ComboBox x:Name="ModelVersionComboBox" Style="{StaticResource ModernComboBoxStyle}"
                          Margin="0,0,0,4" IsEditable="True">
                    <ComboBoxItem Content="GPT-4" IsSelected="True"/>
                    <ComboBoxItem Content="GPT-4 Turbo"/>
                    <ComboBoxItem Content="GPT-3.5"/>
                </ComboBox>
                <TextBlock Text="You can type a custom model version" 
                           FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" 
                           Margin="0,0,0,20"/>

                <!-- Tags -->
                <TextBlock Text="Tags (optional)" FontSize="14" FontWeight="SemiBold" 
                           Foreground="{DynamicResource TextBrush}" Margin="0,0,0,8"/>
                <TextBox x:Name="TagsTextBox" Style="{StaticResource ModernTextBoxStyle}" 
                         Margin="0,0,0,4"/>
                <TextBlock Text="Separate multiple tags with commas (e.g., coding, review, debugging)" 
                           FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" 
                           Margin="0,0,0,20"/>

                <!-- Content -->
                <TextBlock Text="Prompt Content *" FontSize="14" FontWeight="SemiBold" 
                           Foreground="{DynamicResource TextBrush}" Margin="0,0,0,8"/>
                <Border BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" 
                        CornerRadius="6" Background="{DynamicResource SurfaceBrush}">
                    <TextBox x:Name="ContentTextBox" 
                             Background="Transparent"
                             Foreground="{DynamicResource TextBrush}"
                             BorderThickness="0"
                             Padding="12"
                             FontSize="14"
                             FontFamily="Consolas, Courier New"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             VerticalScrollBarVisibility="Auto"
                             Height="250"/>
                </Border>
                <TextBlock x:Name="CharacterCountText" Text="Characters: 0 | Estimated tokens: ~0" 
                           FontSize="12" Foreground="{DynamicResource TextSecondaryBrush}" 
                           Margin="0,4,0,20" HorizontalAlignment="Right"/>
				<!-- Cost Estimate Panel -->
				<Border x:Name="CostEstimatePanel"
						Visibility="Collapsed"
						Background="{DynamicResource CardBrush}"
						BorderBrush="{DynamicResource BorderBrush}"
						BorderThickness="1"
						CornerRadius="8"
						Padding="16"
						Margin="0,12,0,0">
					<Grid>
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="Auto"/>
						</Grid.RowDefinitions>

						<!-- Header -->
						<TextBlock Grid.Row="0"
								   Text="💰 Cost Estimate (per API call)"
								   FontSize="14"
								   FontWeight="SemiBold"
								   Foreground="{DynamicResource TextBrush}"
								   Margin="0,0,0,12"/>

						<!-- Cost Details Grid -->
						<Grid Grid.Row="1">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>

							<!-- Input -->
							<StackPanel Grid.Column="0">
								<TextBlock Text="Input Tokens"
										   FontSize="11"
										   Foreground="{DynamicResource TextSecondaryBrush}"/>
								<TextBlock x:Name="InputTokensText"
										   Text="0"
										   FontSize="16"
										   FontWeight="Bold"
										   Foreground="#2196F3"
										   Margin="0,4,0,0"/>
								<TextBlock x:Name="InputCostText"
										   Text="$0.00"
										   FontSize="12"
										   Foreground="#4CAF50"
										   Margin="0,2,0,0"/>
							</StackPanel>

							<!-- Output (Estimated) -->
							<StackPanel Grid.Column="1">
								<TextBlock Text="Output Tokens (est.)"
										   FontSize="11"
										   Foreground="{DynamicResource TextSecondaryBrush}"/>
								<TextBlock x:Name="OutputTokensText"
										   Text="0"
										   FontSize="16"
										   FontWeight="Bold"
										   Foreground="#FF9800"
										   Margin="0,4,0,0"/>
								<TextBlock x:Name="OutputCostText"
										   Text="$0.00"
										   FontSize="12"
										   Foreground="#4CAF50"
										   Margin="0,2,0,0"/>
							</StackPanel>

							<!-- Total -->
							<StackPanel Grid.Column="2">
								<TextBlock Text="Total Cost"
										   FontSize="11"
										   Foreground="{DynamicResource TextSecondaryBrush}"/>
								<TextBlock x:Name="TotalCostText"
										   Text="$0.00"
										   FontSize="18"
										   FontWeight="Bold"
										   Foreground="#4CAF50"
										   Margin="0,4,0,0"/>
							</StackPanel>
						</Grid>

						<!-- Pricing Info -->
						<TextBlock x:Name="PricingInfoText"
								   Grid.Row="2"
								   Text="Pricing info"
								   FontSize="10"
								   FontStyle="Italic"
								   Foreground="{DynamicResource TextSecondaryBrush}"
								   Margin="0,12,0,0"
								   TextWrapping="Wrap"/>
					</Grid>
				</Border>

                <!-- Favorite Checkbox -->
                <CheckBox x:Name="FavoriteCheckBox" Content="⭐ Mark as Favorite" 
                          Foreground="{DynamicResource TextBrush}" FontSize="14" 
                          Margin="0,0,0,20"/>
            </StackPanel>
        </ScrollViewer>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" 
                    HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button x:Name="CancelButton" Content="Cancel" 
                    Style="{StaticResource SecondaryButtonStyle}" 
                    Width="120" Margin="0,0,12,0"
                    Click="CancelButton_Click"/>
            <Button x:Name="SaveButton" Content="💾 Save Prompt" 
                    Style="{StaticResource ModernButtonStyle}" 
                    Width="150"
                    Click="SaveButton_Click"/>
        </StackPanel>
    </Grid>
</Window>